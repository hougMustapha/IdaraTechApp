"use strict";(self.webpackChunkCommunesApp=self.webpackChunkCommunesApp||[]).push([[494],{4494:(be,T,g)=>{g.r(T),g.d(T,{AccountModule:()=>ve});var d=g(6895),I=g(4466),m=g(8184),b=g(5861),e=g(1571),s=g(433),h=g(5698);class w{constructor(a,t,n){this.accessToken=a,this.userId=t,this.provider=n}}var k=g(5656),f=g(9479),_=g(2761),v=g(8860);const A=["googleButton"];function E(i,a){1&i&&(e.TgZ(0,"span",23),e._uU(1," Username is required "),e.qZA())}function N(i,a){1&i&&(e.TgZ(0,"span",23),e._uU(1," Password is required "),e.qZA())}function J(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"a",27),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.resendEmailConfirmationLink())}),e._uU(1," Click here to resend email confirmation link in case you didn't receive it. "),e.qZA()}}function S(i,a){if(1&i&&(e.TgZ(0,"div",24),e._UZ(1,"app-validation-messages",25),e.YNc(2,J,2,0,"a",26),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("errorMessages",t.errorMessages),e.xp6(1),e.Q6J("ngIf",t.errorMessages[0].includes("Please confirm your email"))}}let Y=(()=>{class i{constructor(t,n,r,o,l,u,c){this.accountService=t,this.formBuilder=n,this.router=r,this.activatedRoute=o,this.sharedService=l,this._renderer2=u,this._document=c,this.googleButton=new e.SBq({}),this.loginForm=new s.cw({}),this.submitted=!1,this.errorMessages=[],this.returnUrl=null,this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:Z=>{Z?this.router.navigateByUrl("/"):this.activatedRoute.queryParamMap.subscribe({next:p=>{p&&(this.returnUrl=p.get("returnUrl"))}})}})}ngOnInit(){this.initializeGoogleButton(),this.initializeForm()}ngAfterViewInit(){const t=this._renderer2.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async="true",t.defer="true",this._renderer2.appendChild(this._document.body,t)}initializeForm(){this.loginForm=this.formBuilder.group({username:["",s.kI.required],password:["",s.kI.required]})}login(){this.submitted=!0,this.errorMessages=[],this.loginForm.valid&&this.accountService.login(this.loginForm.value).subscribe({next:t=>{this.router.navigateByUrl(this.returnUrl?this.returnUrl:"/")},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}})}loginWithFacebook(){var t=this;FB.login(function(){var n=(0,b.Z)(function*(r){r.authResponse?t.accountService.loginWithThirdParty(new w(r.authResponse.accessToken,r.authResponse.userID,"facebook")).subscribe({next:()=>{t.router.navigateByUrl(t.returnUrl?t.returnUrl:"/")},error:u=>{t.sharedService.showNotification(!1,"Echec",u.error)}}):t.sharedService.showNotification(!1,"\xc9chec","Impossible de se connect\xe9 avec votre Facebook")});return function(r){return n.apply(this,arguments)}}())}resendEmailConfirmationLink(){this.router.navigateByUrl("/account/send-email/resend-email-confirmation-link")}initializeGoogleButton(){window.onGoogleLibraryLoad=()=>{google.accounts.id.initialize({client_id:"705557142395-enjbmqapu1rrhaoj25d68okdkoi43ii6.apps.googleusercontent.com",callback:this.googleCallback.bind(this),auto_select:!1,cancel_on_tap_outside:!0}),google.accounts.id.renderButton(this.googleButton.nativeElement,{size:"medium",shape:"rectangular",text:"signin_with",logo_alignment:"center"})}}googleCallback(t){var n=this;return(0,b.Z)(function*(){const r=(0,k.o)(t.credential);n.accountService.loginWithThirdParty(new w(t.credential,r.sub,"google")).subscribe({next:o=>{n.router.navigateByUrl(n.returnUrl?n.returnUrl:"/")},error:o=>{n.sharedService.showNotification(!1,"Echec",o.error)}})})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(s.qu),e.Y36(m.F0),e.Y36(m.gz),e.Y36(_.F),e.Y36(e.Qsj),e.Y36(d.K0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],viewQuery:function(n,r){if(1&n&&e.Gf(A,7),2&n){let o;e.iGM(o=e.CRH())&&(r.googleButton=o.first)}},decls:37,vars:8,consts:[[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],[1,"form-floating","mb-3"],["formControlName","username","type","text","placeholder","Nom d'utilisateur (votre adresse mail)",1,"form-control"],["for","username"],["class","text-danger",4,"ngIf"],["formControlName","password","type","password","placeholder","Mot de passe",1,"form-control"],["for","password"],["class","form-floatin",4,"ngIf"],[1,"d-grid","mt-4","px-1"],["type","submit",1,"btn","btn-lg","btn-info"],[1,"mt-4","text-center"],["routerLink","/account/send-email/forgot-username-or-password",1,"btn","btn-link"],[1,"row","d-flex","justify-content-center","mt-3"],[1,"col-3"],[1,"col-5","text"],[1,"d-flex","justify-content-between","my-3"],["googleButton",""],[1,"btn","btn-primary","btn-sm",2,"width","180px",3,"click"],[1,"text-danger"],[1,"form-floatin"],[3,"errorMessages"],["class","btn btn-link",3,"click",4,"ngIf"],[1,"btn","btn-link",3,"click"]],template:function(n,r){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"main",2)(3,"form",3),e.NdJ("ngSubmit",function(){return r.login()}),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Connexion"),e.qZA()(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.TgZ(9,"label",8),e._uU(10,"Nom d'utilisateur (votre adresse mail)"),e.qZA(),e.YNc(11,E,2,0,"span",9),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"input",10),e.TgZ(14,"label",11),e._uU(15,"Mot de passe"),e.qZA(),e.YNc(16,N,2,0,"span",9),e.qZA(),e.YNc(17,S,3,2,"div",12),e.TgZ(18,"div",13)(19,"button",14),e._uU(20,"Se connecter"),e.qZA()()(),e.TgZ(21,"div",15)(22,"a",16)(23,"h6"),e._uU(24,"Nom d'utilisateur ou mot de passe oubli\xe9"),e.qZA()()(),e.TgZ(25,"div",17)(26,"div",18),e._UZ(27,"hr"),e.qZA(),e.TgZ(28,"div",19),e._uU(29,"Ou connectez-vous en utilisant"),e.qZA(),e.TgZ(30,"div",18),e._UZ(31,"hr"),e.qZA()(),e.TgZ(32,"div",20),e._UZ(33,"div",null,21),e.TgZ(35,"button",22),e.NdJ("click",function(){return r.loginWithFacebook()}),e._uU(36," Facebook "),e.qZA()()()()()),2&n){let o,l,u,c;e.xp6(3),e.Q6J("formGroup",r.loginForm),e.xp6(5),e.ekj("is-invalid",r.submitted&&(null==(o=r.loginForm.get("username"))?null:o.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(l=r.loginForm.get("username"))?null:l.hasError("required"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(u=r.loginForm.get("username"))?null:u.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(c=r.loginForm.get("password"))?null:c.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.errorMessages.length>0)}},dependencies:[d.O5,m.rH,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,v.s]})}return i})();const B=["googleButton"];function M(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," First name is required "),e.qZA())}function P(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," First name must be at least 3, and maximum 15 characters "),e.qZA())}function R(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Last name is required "),e.qZA())}function Q(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Last name must be at least 3, and maximum 15 characters "),e.qZA())}function L(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Email is required "),e.qZA())}function j(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Invalid email address "),e.qZA())}function z(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Password is required "),e.qZA())}function G(i,a){1&i&&(e.TgZ(0,"span",25),e._uU(1," Password must be at least 6, and maximum 15 characters "),e.qZA())}function W(i,a){if(1&i&&(e.TgZ(0,"div",26),e._UZ(1,"app-validation-messages",27),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("errorMessages",t.errorMessages)}}let O=(()=>{class i{constructor(t,n,r,o,l,u){this.accountService=t,this.sharedService=n,this.formBuilder=r,this.router=o,this._renderer2=l,this._document=u,this.googleButton=new e.SBq({}),this.registerForm=new s.cw({}),this.submitted=!1,this.errorMessages=[],this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:c=>{c&&this.router.navigateByUrl("/")}})}ngOnInit(){this.initializeGoogleButton(),this.initializeForm()}ngAfterViewInit(){const t=this._renderer2.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async="true",t.defer="true",this._renderer2.appendChild(this._document.body,t)}initializeForm(){this.registerForm=this.formBuilder.group({firstname:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(15)]],lastname:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(15)]],email:["",[s.kI.required,s.kI.pattern("^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$")]],password:["",[s.kI.required,s.kI.minLength(6),s.kI.maxLength(15)]]})}register(){this.submitted=!0,this.errorMessages=[],this.registerForm.valid&&this.accountService.register(this.registerForm.value).subscribe({next:t=>{this.sharedService.showNotification(!0,t.value.title,t.value.message),this.router.navigateByUrl("/account/login"),console.log(t)},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}})}registerWithFacebook(){var t=this;FB.login(function(){var n=(0,b.Z)(function*(r){r.authResponse?t.router.navigateByUrl(`/account/register/third-party/facebook?access_token=${r.authResponse.accessToken}&userId=${r.authResponse.userID}`):t.sharedService.showNotification(!1,"\xc9chec","Impossible de s'inscrire avec votre Facebook")});return function(r){return n.apply(this,arguments)}}())}initializeGoogleButton(){window.onGoogleLibraryLoad=()=>{google.accounts.id.initialize({client_id:"705557142395-enjbmqapu1rrhaoj25d68okdkoi43ii6.apps.googleusercontent.com",callback:this.googleCallback.bind(this),auto_select:!1,cancel_on_tap_outside:!0}),google.accounts.id.renderButton(this.googleButton.nativeElement,{size:"medium",shape:"rectangular",text:"signup_with",logo_alignment:"center"})}}googleCallback(t){var n=this;return(0,b.Z)(function*(){const r=(0,k.o)(t.credential);n.router.navigateByUrl(`/account/register/third-party/google?access_token=${t.credential}&userId=${r.sub}`)})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(_.F),e.Y36(s.qu),e.Y36(m.F0),e.Y36(e.Qsj),e.Y36(d.K0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-register"]],viewQuery:function(n,r){if(1&n&&e.Gf(B,7),2&n){let o;e.iGM(o=e.CRH())&&(r.googleButton=o.first)}},decls:47,vars:18,consts:[[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],[1,"form-floating","mb-3"],["formControlName","firstname","type","text","placeholder","Pr\xe9nom",1,"form-control"],["for","firstname"],["class","text-danger",4,"ngIf"],["formControlName","lastname","type","text","placeholder","Nom",1,"form-control"],["for","lastname"],["formControlName","email","type","text","placeholder","Email",1,"form-control"],["for","email"],["formControlName","password","type","password","placeholder","Mot de passe",1,"form-control"],["for","password"],["class","form-floatin",4,"ngIf"],[1,"d-grid","mt-4","px-1"],["type","submit",1,"btn","btn-lg","btn-info"],[1,"row","d-flex","justify-content-center","mt-3"],[1,"col-3"],[1,"col-5","text"],[1,"d-flex","justify-content-between","my-3"],["googleButton",""],[1,"btn","btn-primary","btn-sm",2,"width","180px",3,"click"],[1,"text-danger"],[1,"form-floatin"],[3,"errorMessages"]],template:function(n,r){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"main",2)(3,"form",3),e.NdJ("ngSubmit",function(){return r.register()}),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6," Inscrivez-vous d\xe8s maintenant "),e.qZA()(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.TgZ(9,"label",8),e._uU(10,"Pr\xe9nom"),e.qZA(),e.YNc(11,M,2,0,"span",9),e.YNc(12,P,2,0,"span",9),e.qZA(),e.TgZ(13,"div",6),e._UZ(14,"input",10),e.TgZ(15,"label",11),e._uU(16,"Nom"),e.qZA(),e.YNc(17,R,2,0,"span",9),e.YNc(18,Q,2,0,"span",9),e.qZA(),e.TgZ(19,"div",6),e._UZ(20,"input",12),e.TgZ(21,"label",13),e._uU(22,"Email"),e.qZA(),e.YNc(23,L,2,0,"span",9),e.YNc(24,j,2,0,"span",9),e.qZA(),e.TgZ(25,"div",6),e._UZ(26,"input",14),e.TgZ(27,"label",15),e._uU(28,"Mot de passe"),e.qZA(),e.YNc(29,z,2,0,"span",9),e.YNc(30,G,2,0,"span",9),e.qZA(),e.YNc(31,W,2,1,"div",16),e.TgZ(32,"div",17)(33,"button",18),e._uU(34,"Cr\xe9er un compte"),e.qZA()()(),e.TgZ(35,"div",19)(36,"div",20),e._UZ(37,"hr"),e.qZA(),e.TgZ(38,"div",21),e._uU(39,"Ou inscrivez-vous en utilisant"),e.qZA(),e.TgZ(40,"div",20),e._UZ(41,"hr"),e.qZA()(),e.TgZ(42,"div",22),e._UZ(43,"div",null,23),e.TgZ(45,"button",24),e.NdJ("click",function(){return r.registerWithFacebook()}),e._uU(46," Facebook "),e.qZA()()()()()),2&n){let o,l,u,c,Z,p,F,y,q,U,C,x;e.xp6(3),e.Q6J("formGroup",r.registerForm),e.xp6(5),e.ekj("is-invalid",r.submitted&&(null==(o=r.registerForm.get("firstname"))?null:o.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(l=r.registerForm.get("firstname"))?null:l.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(u=r.registerForm.get("firstname"))?null:u.hasError("minlength"))||(null==(u=r.registerForm.get("firstname"))?null:u.hasError("maxlength"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(c=r.registerForm.get("lastname"))?null:c.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(Z=r.registerForm.get("lastname"))?null:Z.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(p=r.registerForm.get("lastname"))?null:p.hasError("minlength"))||(null==(p=r.registerForm.get("lastname"))?null:p.hasError("maxlength"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(F=r.registerForm.get("email"))?null:F.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(y=r.registerForm.get("email"))?null:y.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(q=r.registerForm.get("email"))?null:q.hasError("pattern"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(U=r.registerForm.get("password"))?null:U.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(C=r.registerForm.get("password"))?null:C.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(x=r.registerForm.get("password"))?null:x.hasError("minlength"))||(null==(x=r.registerForm.get("password"))?null:x.hasError("maxlength"))),e.xp6(1),e.Q6J("ngIf",r.errorMessages.length>0)}},dependencies:[d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,v.s]})}return i})();function $(i,a){1&i&&(e.TgZ(0,"div",1)(1,"a",2),e._uU(2," Login "),e.qZA()())}function H(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"a",3),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.resendEmailConfirmationLink())}),e._uU(2," Click here to resend email confirmation link "),e.qZA()()}}let K=(()=>{class i{constructor(t,n,r,o){this.accountService=t,this.sharedService=n,this.router=r,this.activatedRoute=o,this.success=!0}ngOnInit(){this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:t=>{t?this.router.navigateByUrl("/"):this.activatedRoute.queryParamMap.subscribe({next:n=>{const r={token:n.get("token"),email:n.get("email")};this.accountService.confirmEmail(r).subscribe({next:o=>{this.sharedService.showNotification(!0,o.value.title,o.value.message)},error:o=>{this.success=!1,this.sharedService.showNotification(!1,"Failed",o.error)}})}})}})}resendEmailConfirmationLink(){this.router.navigateByUrl("/account/send-email/resend-email-confirmation-link")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(_.F),e.Y36(m.F0),e.Y36(m.gz))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-confirm-email"]],decls:2,vars:2,consts:[["class","container text-center",4,"ngIf"],[1,"container","text-center"],["routerLink","/account/login",1,"btn","btn-primary"],[1,"btn","btn-link",3,"click"]],template:function(n,r){1&n&&(e.YNc(0,$,3,0,"div",0),e.YNc(1,H,3,0,"div",0)),2&n&&(e.Q6J("ngIf",r.success),e.xp6(1),e.Q6J("ngIf",!r.success))},dependencies:[d.O5,m.rH]})}return i})();function X(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1," Resend email confirmation link "),e.qZA())}function D(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1," Retrieve your username or password "),e.qZA())}function V(i,a){1&i&&(e.TgZ(0,"span",18),e._uU(1," Email required "),e.qZA())}function ee(i,a){1&i&&(e.TgZ(0,"span",18),e._uU(1," Invalid email address "),e.qZA())}function te(i,a){if(1&i&&(e.TgZ(0,"div",19),e._UZ(1,"app-validation-messages",20),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("errorMessages",t.errorMessages)}}function re(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"main",3)(3,"form",4),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sendEmail())}),e.TgZ(4,"div",5)(5,"h1",6),e.YNc(6,X,2,0,"span",7),e.YNc(7,D,2,0,"span",7),e.qZA()(),e.TgZ(8,"div",8),e._UZ(9,"input",9),e.TgZ(10,"label",10),e._uU(11,"Email"),e.qZA(),e.YNc(12,V,2,0,"span",11),e.YNc(13,ee,2,0,"span",11),e.qZA(),e.YNc(14,te,2,1,"div",12),e.TgZ(15,"div",13)(16,"div",14)(17,"div",15)(18,"button",16),e._uU(19,"Envoyer"),e.qZA()()(),e.TgZ(20,"div",14)(21,"div",15)(22,"button",17),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancel())}),e._uU(23,"Annuler"),e.qZA()()()()()()()()}if(2&i){const t=e.oxw();let n,r,o;e.xp6(3),e.Q6J("formGroup",t.emailForm),e.xp6(3),e.Q6J("ngIf",t.mode.includes("resend-email-confirmation-link")),e.xp6(1),e.Q6J("ngIf",t.mode.includes("forgot-username-or-password")),e.xp6(2),e.ekj("is-invalid",t.submitted&&(null==(n=t.emailForm.get("email"))?null:n.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(r=t.emailForm.get("email"))?null:r.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(o=t.emailForm.get("email"))?null:o.hasError("pattern"))),e.xp6(1),e.Q6J("ngIf",t.errorMessages.length>0)}}let ie=(()=>{class i{constructor(t,n,r,o,l){this.accountService=t,this.sharedService=n,this.formBuilder=r,this.router=o,this.activatedRoute=l,this.emailForm=new s.cw({}),this.submitted=!1,this.errorMessages=[]}ngOnInit(){this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:t=>{if(t)this.router.navigateByUrl("/");else{const n=this.activatedRoute.snapshot.paramMap.get("mode");n&&(this.mode=n,console.log(this.mode),this.initializeForm())}}})}initializeForm(){this.emailForm=this.formBuilder.group({email:["",[s.kI.required,s.kI.pattern("^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$")]]})}sendEmail(){this.submitted=!0,this.errorMessages=[],this.emailForm.valid&&this.mode&&(this.mode.includes("resend-email-confirmation-link")?this.accountService.resendEmailConfirmationLink(this.emailForm.get("email")?.value).subscribe({next:t=>{this.sharedService.showNotification(!0,t.value.title,t.value.message),this.router.navigateByUrl("/account/login")},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}}):this.mode.includes("forgot-username-or-password")&&this.accountService.forgotUsernameOrPassword(this.emailForm.get("email")?.value).subscribe({next:t=>{this.sharedService.showNotification(!0,t.value.title,t.value.message),this.router.navigateByUrl("/account/login")},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}}))}cancel(){this.router.navigateByUrl("/account/login")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(_.F),e.Y36(s.qu),e.Y36(m.F0),e.Y36(m.gz))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-send-email"]],decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",1,"form-signin",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],[4,"ngIf"],[1,"form-floating","mb-3"],["formControlName","email","type","text","placeholder","Email",1,"form-control"],["for","email"],["class","text-danger",4,"ngIf"],["class","form-floatin",4,"ngIf"],[1,"row"],[1,"col-6"],[1,"d-grid"],["type","submit",1,"btn","btn-block","btn-success"],["type","button",1,"btn","btn-block","btn-danger",3,"click"],[1,"text-danger"],[1,"form-floatin"],[3,"errorMessages"]],template:function(n,r){1&n&&e.YNc(0,re,24,8,"div",0),2&n&&e.Q6J("ngIf",r.mode)},dependencies:[d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,v.s]})}return i})();function ne(i,a){1&i&&(e.TgZ(0,"span",19),e._uU(1," Nouveau mot de passe est requis "),e.qZA())}function se(i,a){1&i&&(e.TgZ(0,"span",19),e._uU(1," New Password must be at least 6, and maximum 15 characters "),e.qZA())}function oe(i,a){if(1&i&&(e.TgZ(0,"div",20),e._UZ(1,"app-validation-messages",21),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("errorMessages",t.errorMessages)}}function ae(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"main",3)(3,"form",4),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.resetPassword())}),e.TgZ(4,"div",5)(5,"h1",6),e._uU(6," Change your password "),e.qZA()(),e.TgZ(7,"div",7),e._UZ(8,"input",8),e.TgZ(9,"label",9),e._uU(10,"Email"),e.qZA()(),e.TgZ(11,"div",7),e._UZ(12,"input",10),e.TgZ(13,"label",11),e._uU(14,"Nouveau mot de passe"),e.qZA(),e.YNc(15,ne,2,0,"span",12),e.YNc(16,se,2,0,"span",12),e.qZA(),e.YNc(17,oe,2,1,"div",13),e.TgZ(18,"div",14)(19,"div",15)(20,"div",16)(21,"button",17),e._uU(22,"Change Password"),e.qZA()()(),e.TgZ(23,"div",15)(24,"div",16)(25,"button",18),e._uU(26,"Annuler"),e.qZA()()()()()()()()}if(2&i){const t=e.oxw();let n,r,o;e.xp6(3),e.Q6J("formGroup",t.resetPasswordForm),e.xp6(9),e.ekj("is-invalid",t.submitted&&(null==(n=t.resetPasswordForm.get("newPassword"))?null:n.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(r=t.resetPasswordForm.get("newPassword"))?null:r.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(o=t.resetPasswordForm.get("newPassword"))?null:o.hasError("minlength"))||(null==(o=t.resetPasswordForm.get("newPassword"))?null:o.hasError("maxlength"))),e.xp6(1),e.Q6J("ngIf",t.errorMessages.length>0)}}let le=(()=>{class i{constructor(t,n,r,o,l){this.accountService=t,this.sharedService=n,this.formBuilder=r,this.router=o,this.activatedRoute=l,this.resetPasswordForm=new s.cw({}),this.submitted=!1,this.errorMessages=[]}ngOnInit(){this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:t=>{t?this.router.navigateByUrl("/"):this.activatedRoute.queryParamMap.subscribe({next:n=>{this.token=n.get("token"),this.email=n.get("email"),this.token&&this.email?this.initializeForm(this.email):this.router.navigateByUrl("/account/login")}})}})}initializeForm(t){this.resetPasswordForm=this.formBuilder.group({email:[{value:t,disable:!0}],newPassword:["",[s.kI.required,s.kI.minLength(6),s.kI.maxLength(15)]]})}resetPassword(){if(this.submitted=!0,this.errorMessages=[],this.resetPasswordForm.valid&&this.email&&this.token){const t={token:this.token,email:this.email,newPassword:this.resetPasswordForm.get("newPassword")?.value};this.accountService.resetPassword(t).subscribe({next:n=>{this.sharedService.showNotification(!0,n.value.title,n.value.message),this.router.navigateByUrl("/account/login")},error:n=>{n.error.errors?this.errorMessages=n.error.errors:this.errorMessages.push(n.error)}})}}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(_.F),e.Y36(s.qu),e.Y36(m.F0),e.Y36(m.gz))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-reset-password"]],decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",1,"form-signin",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],[1,"form-floating","mb-3"],["formControlName","email","type","text","placeholder","Email",1,"form-control"],["for","email"],["formControlName","newPassword","type","password","placeholder","Nouveau mot de passe",1,"form-control"],["for","newPassword"],["class","text-danger",4,"ngIf"],["class","form-floatin",4,"ngIf"],[1,"row"],[1,"col-6"],[1,"d-grid"],["type","submit",1,"btn","btn-block","btn-success"],["type","button","routerLink","/account/login",1,"btn","btn-block","btn-danger"],[1,"text-danger"],[1,"form-floatin"],[3,"errorMessages"]],template:function(n,r){1&n&&e.YNc(0,ae,27,6,"div",0),2&n&&e.Q6J("ngIf",r.token&&r.email)},dependencies:[d.O5,m.rH,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,v.s]})}return i})();class me{constructor(a,t,n,r,o){this.firstName=a,this.lastName=t,this.userId=n,this.accessToken=r,this.provider=o}}function ue(i,a){1&i&&(e.TgZ(0,"span",17),e._uU(1," First name is required "),e.qZA())}function ce(i,a){1&i&&(e.TgZ(0,"span",17),e._uU(1," First name must be at least 3, and maximum 15 characters "),e.qZA())}function ge(i,a){1&i&&(e.TgZ(0,"span",17),e._uU(1," Last name is required "),e.qZA())}function de(i,a){1&i&&(e.TgZ(0,"span",17),e._uU(1," Last name must be at least 3, and maximum 15 characters "),e.qZA())}function pe(i,a){if(1&i&&(e.TgZ(0,"div",18),e._UZ(1,"app-validation-messages",19),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("errorMessages",t.errorMessages)}}function he(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"main",3)(3,"form",4),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.register())}),e.TgZ(4,"div",5)(5,"h3",6),e._uU(6," Cr\xe9er un compte en utilisant votre "),e.TgZ(7,"span",7),e._uU(8),e.ALo(9,"titlecase"),e.qZA()()(),e.TgZ(10,"div",8),e._UZ(11,"input",9),e.TgZ(12,"label",10),e._uU(13,"Pr\xe9nom"),e.qZA(),e.YNc(14,ue,2,0,"span",11),e.YNc(15,ce,2,0,"span",11),e.qZA(),e.TgZ(16,"div",8),e._UZ(17,"input",12),e.TgZ(18,"label",13),e._uU(19,"Nom"),e.qZA(),e.YNc(20,ge,2,0,"span",11),e.YNc(21,de,2,0,"span",11),e.qZA(),e.YNc(22,pe,2,1,"div",14),e.TgZ(23,"div",15)(24,"button",16),e._uU(25,"Cr\xe9er un compte"),e.qZA()()()()()()}if(2&i){const t=e.oxw();let n,r,o,l,u,c;e.xp6(3),e.Q6J("formGroup",t.registerForm),e.xp6(5),e.Oqu(e.lcZ(9,11,t.provider)),e.xp6(3),e.ekj("is-invalid",t.submitted&&(null==(n=t.registerForm.get("firstname"))?null:n.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(r=t.registerForm.get("firstname"))?null:r.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(o=t.registerForm.get("firstname"))?null:o.hasError("minlength"))||(null==(o=t.registerForm.get("firstname"))?null:o.hasError("maxlength"))),e.xp6(2),e.ekj("is-invalid",t.submitted&&(null==(l=t.registerForm.get("lastname"))?null:l.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(u=t.registerForm.get("lastname"))?null:u.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(c=t.registerForm.get("lastname"))?null:c.hasError("minlength"))||(null==(c=t.registerForm.get("lastname"))?null:c.hasError("maxlength"))),e.xp6(1),e.Q6J("ngIf",t.errorMessages.length>0)}}const fe=[{path:"login",component:Y},{path:"register",component:O},{path:"confirm-email",component:K},{path:"send-email/:mode",component:ie},{path:"reset-password",component:le},{path:"register/third-party/:provider",component:(()=>{class i{constructor(t,n,r,o){this.accountService=t,this.router=n,this.activatedRoute=r,this.formBuilder=o,this.registerForm=new s.cw({}),this.submitted=!1,this.provider=null,this.access_token=null,this.userId=null,this.errorMessages=[]}ngOnInit(){this.accountService.user$.pipe((0,h.q)(1)).subscribe({next:t=>{t?this.router.navigateByUrl("/"):this.activatedRoute.queryParamMap.subscribe({next:n=>{this.provider=this.activatedRoute.snapshot.paramMap.get("provider"),this.access_token=n.get("access_token"),this.userId=n.get("userId"),this.provider&&this.access_token&&this.userId&&("facebook"===this.provider||"google"===this.provider)?this.initializeForm():this.router.navigateByUrl("/account/register")}})}})}initializeForm(){this.registerForm=this.formBuilder.group({firstname:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(15)]],lastname:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(15)]]})}register(){if(this.submitted=!0,this.errorMessages=[],this.registerForm.valid&&this.userId&&this.access_token&&this.provider){const t=this.registerForm.get("firstname")?.value,n=this.registerForm.get("lastname")?.value,r=new me(t,n,this.userId,this.access_token,this.provider);this.accountService.registerWithThirdParty(r).subscribe({next:o=>{this.router.navigateByUrl("/")},error:o=>{o.error.errors?this.errorMessages=o.error.errors:this.errorMessages.push(o.error)}})}}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(f.B),e.Y36(m.F0),e.Y36(m.gz),e.Y36(s.qu))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-register-with-third-party"]],decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],[1,"text-warning"],[1,"form-floating","mb-3"],["formControlName","firstname","type","text","placeholder","Pr\xe9nom",1,"form-control"],["for","firstname"],["class","text-danger",4,"ngIf"],["formControlName","lastname","type","text","placeholder","Nom",1,"form-control"],["for","lastname"],["class","form-floatin",4,"ngIf"],[1,"d-grid","mt-4","px-1"],["type","submit",1,"btn","btn-lg","btn-info"],[1,"text-danger"],[1,"form-floatin"],[3,"errorMessages"]],template:function(n,r){1&n&&e.YNc(0,he,26,13,"div",0),2&n&&e.Q6J("ngIf",r.provider&&r.access_token&&r.userId)},dependencies:[d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,v.s,d.rS]})}return i})()}];let _e=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#r=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(fe),m.Bz]})}return i})(),ve=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#r=this.\u0275inj=e.cJS({imports:[d.ez,_e,I.m]})}return i})()}}]);